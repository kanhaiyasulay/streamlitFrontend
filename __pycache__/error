async def chat_instance_stream(user_question, context: FinOpsContext):

    schema = context.schema
    model = context.model

    # Convert schema to string separately (avoids f-string confusion)
    schema_json = json.dumps(schema, indent=2)

    prompt = (
        "You are a FinOps expert.\n\n"
        "Answer the user question using this schema.\n"
        "If calculation is requested, generate a DAX query.\n\n"
        "Return format:\n\n"
        "Answer:\n"
        "<business explanation>\n\n"
        "DAX Query (if applicable):\n"
        "```DAX\n"
        "<query>\n"
        "```\n\n"
        "Schema:\n"
        + schema_json +
        "\n\nUser Question:\n"
        + user_question
    )

    response = await model.ainvoke(prompt)
    return response.content
