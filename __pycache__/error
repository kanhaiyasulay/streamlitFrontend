if dax_query:
    try:
        result = execute_dax_query(dax_query)

        rows = result["results"][0]["tables"][0]["rows"]

        if not rows:
            formatted_output = "No data available for the selected period."
        else:
            formatted_output = ""

            for row in rows:
                formatted_output += "\n"
                for key, value in row.items():
                    formatted_output += f"{key}: {round(value, 2) if isinstance(value, float) else value}  "
                formatted_output += "\n"

        return llm_text + "\n\n---\n### ✅ Live Result\n" + formatted_output

    except Exception as e:
        return llm_text + f"\n\n⚠️ DAX execution failed: {str(e)}"
